<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polycarbonate</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            min-height: 100vh;
            overflow-x: hidden;
            overflow-y: auto;
        }

        .parallax-container {
            position: fixed;
            width: 50vw;
            height: 50vh;
            perspective: 1000px;
            transform-style: preserve-3d;
            transform: scale(2);
            transform-origin: 0 0;
            image-rendering: pixelated;
            z-index: 1;
            opacity: 0;
            transition: opacity 1s ease-in;
        }

        .layer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform-style: preserve-3d;
            will-change: transform;
            transition: transform 0.1s ease-out;
            image-rendering: pixelated;
            width: 100%;
            height: 100%;
        }

        #layer1 {
            width: 100%;
            height: 100%;
            transform: translate(-50%, -50%) translateZ(0px) scale(1.2);
        }

        #layer2 {
            width: 100%;
            height: 100%;
            transform: translate(-50%, -50%) translateZ(0px) scale(1.2);
            filter: blur(1px);
        }

        #layer3 {
            width: 100%;
            height: 100%;
            transform: translate(-50%, -50%) translateZ(0px) scale(1.2);
        }

        .layer img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            pointer-events: none;
            image-rendering: pixelated;
        }

        .content {
            position: relative;
            min-height: 300vh;
            z-index: 2;
        }

        #noise {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.05;
            z-index: 1000;
            image-rendering: pixelated;
        }

        #antialias {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
            backdrop-filter: blur(0.5px);
        }

        @import url('https://fonts.googleapis.com/css2?family=Crimson+Text:wght@700&display=swap');

        .title-wrapper {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 998;
        }

        #title-canvas {
            image-rendering: pixelated;
            transform: scale(4);
            transform-origin: center;
        }

        .title-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 998;
            transform: scale(2);
            transform-origin: 0 0;
            image-rendering: pixelated;
        }

        .fade-in {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="title-wrapper">
        <canvas id="title-canvas"></canvas>
    </div>
    <div id="antialias"></div>
    <canvas id="noise"></canvas>
    <div class="parallax-container" style="width: 50vw; height: 50vh;">
        <div class="layer" id="layer1">
            <img src="layer1.png" alt="Background Layer">
        </div>
        <div class="layer" id="layer2">
            <img src="layer2.png" alt="Middle Layer">
        </div>
        <div class="layer" id="layer3">
            <img src="layer3.png" alt="Foreground Layer">
        </div>
    </div>
    <div class="content"></div>

    <script>
        // Noise effect variables
        const noise = document.getElementById('noise');
        const ctx = noise.getContext('2d', { antialias: false });
        const FPS = 30;
        const frameDelay = 1000 / FPS;
        let lastDrawTime = 0;

        // Parallax variables
        const container = document.querySelector('.parallax-container');
        const layers = document.querySelectorAll('.layer');
        const images = document.querySelectorAll('img');
        const parallaxContainer = document.querySelector('.parallax-container');
        
        let mouseX = 0;
        let mouseY = 0;
        let windowWidth = window.innerWidth;
        let windowHeight = window.innerHeight;
        let currentX = 0;
        let currentY = 0;
        let targetX = 0;
        let targetY = 0;

        // Film noise effect functions
        function setupNoise() {
            noise.width = Math.floor(window.innerWidth / 4);
            noise.height = Math.floor(window.innerHeight / 4);
            ctx.imageSmoothingEnabled = false;
        }
        
        function drawNoise(currentTime) {
            if (!lastDrawTime) lastDrawTime = currentTime;
            const elapsed = currentTime - lastDrawTime;

            if (elapsed > frameDelay) {
                const imageData = ctx.createImageData(noise.width, noise.height);
                const data = imageData.data;
                
                for (let i = 0; i < data.length; i += 4) {
                    const value = Math.random() * 255;
                    data[i] = value;     // red
                    data[i + 1] = value; // green
                    data[i + 2] = value; // blue
                    data[i + 3] = 255;   // alpha
                }
                
                ctx.putImageData(imageData, 0, 0);
                lastDrawTime = currentTime;
            }
            
            requestAnimationFrame(drawNoise);
        }

        // Initialize noise effect
        setupNoise();
        requestAnimationFrame(drawNoise);

        // Wait for both fonts and images
        Promise.all([
            document.fonts.ready,
            ...Array.from(images).map(img => {
                return new Promise((resolve, reject) => {
                    if (img.complete) resolve();
                    img.onload = resolve;
                    img.onerror = reject;
                });
            })
        ]).then(() => {
            setupText();
            parallaxContainer.classList.add('fade-in');
            animate();
        }).catch(error => {
            console.error('Error loading resources:', error);
        });

        window.addEventListener('mousemove', (e) => {
            mouseX = (e.clientX - windowWidth / 2);
            mouseY = (e.clientY - windowHeight / 2);
            
            targetX = (mouseX / windowWidth) * 6;
            targetY = (mouseY / windowHeight) * 6;
        });

        window.addEventListener('resize', () => {
            windowWidth = window.innerWidth;
            windowHeight = window.innerHeight;
            setupNoise();
            setupText();
        });

        function animate() {
            currentX += (targetX - currentX) * 0.1;
            currentY += (targetY - currentY) * 0.1;

            layers.forEach((layer, index) => {
                const moveX = currentX * (index + 1);
                const moveY = currentY * (index + 1);
                
                layer.style.transform = `translate(-50%, -50%) 
                    translateX(${moveX}px) 
                    translateY(${moveY}px) 
                    scale(1.2)`;
            });

            requestAnimationFrame(animate);
        }

        // Text rendering
        const titleCanvas = document.getElementById('title-canvas');
        const titleCtx = titleCanvas.getContext('2d');
        
        function setupText() {
            // Set base canvas size to 1/4 of what we want the final size to be
            titleCanvas.width = Math.floor(window.innerWidth / 4);
            titleCanvas.height = Math.floor(window.innerHeight / 4);
            
            // Disable image smoothing for crisp pixels
            titleCtx.imageSmoothingEnabled = false;
            
            const text = "hey, i'm polycarbonate";
            const centerX = titleCanvas.width / 2;
            const centerY = titleCanvas.height / 2;

            // Set text properties
            titleCtx.textAlign = 'center';
            titleCtx.textBaseline = 'middle';
            titleCtx.font = '20px "Crimson Text"';

            // Draw dark outline first
            titleCtx.strokeStyle = 'rgba(0, 0, 0, 0.8)';
            titleCtx.lineWidth = 3;
            titleCtx.strokeText(text, centerX, centerY);
            
            // Draw outer glow layers
            titleCtx.fillStyle = 'rgba(255, 140, 0, 0.3)';
            titleCtx.shadowColor = 'rgba(255, 140, 0, 0.3)';
            titleCtx.shadowBlur = 8;
            titleCtx.fillText(text, centerX, centerY);

            titleCtx.fillStyle = 'rgba(255, 140, 0, 0.5)';
            titleCtx.shadowColor = 'rgba(255, 140, 0, 0.5)';
            titleCtx.shadowBlur = 6;
            titleCtx.fillText(text, centerX, centerY);

            titleCtx.fillStyle = 'rgba(255, 140, 0, 0.7)';
            titleCtx.shadowColor = 'rgba(255, 140, 0, 0.7)';
            titleCtx.shadowBlur = 4;
            titleCtx.fillText(text, centerX, centerY);

            // Draw main text with brightest glow
            titleCtx.fillStyle = '#ffd280';
            titleCtx.shadowColor = 'rgba(255, 176, 0, 0.9)';
            titleCtx.shadowBlur = 2;
            titleCtx.fillText(text, centerX, centerY);

            // Final pass without shadow for crisp text
            titleCtx.shadowBlur = 0;
            titleCtx.fillText(text, centerX, centerY);
        }

        // Wait for font to load before rendering text
        document.fonts.ready.then(setupText);
        window.addEventListener('resize', setupText);
    </script>
</body>
</html>